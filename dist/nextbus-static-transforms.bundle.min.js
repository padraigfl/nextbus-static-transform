!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define("nextbus-static-transforms.bundle",[],e):"object"==typeof exports?exports["nextbus-static-transforms.bundle"]=e():t["nextbus-static-transforms.bundle"]=e()}(window,function(){return function(t){var e={};function r(o){if(e[o])return e[o].exports;var n=e[o]={i:o,l:!1,exports:{}};return t[o].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=t,r.c=e,r.d=function(t,e,o){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:o})},r.r=function(t){Object.defineProperty(t,"__esModule",{value:!0})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=5)}([function(t,e,r){"use strict";t.exports=function(t){return Array.isArray(t)||(t=[t]),t}},function(t,e,r){"use strict";var o=r(0);t.exports={buildStopPoint:function(t){return{type:"Feature",properties:{title:t.title,tag:t.tag,stopId:t.stopId},geometry:{type:"Point",coordinates:[parseFloat(t.lon),parseFloat(t.lat)]}}},buildRoute:function(t){return{type:"Feature",properties:{title:t.route.title,tag:t.route.tag,color:t.route.color},geometry:{type:"MultiLineString",coordinates:(e=o(t.route.path),(e=o(e)).map(function(t){return o(t.point).map(function(t){return[parseFloat(t.lon),parseFloat(t.lat)]})}))}};var e},buildFeaturesShell:function(t){return{type:"FeatureCollection",features:[],copyright:t}}}},function(t,e,r){"use strict";var o=r(0);function n(t){return[parseFloat(t[0]),parseFloat(t[1])]}function u(t){for(var e in t)if("-1"!==t[e].epochTime)return t[e].content;return"fail"}function a(t,e,r){var u,a,i,s,c;e||(e={data:{}}),r||(r={data:{}}),u=e,a=r,i=t.copyright,u.copyright||(u.copyright=i),a.copyright||(a.copyright=i);try{r.data=(s=t.route.stop,c=r.data,(s=o(s)).forEach(function(t){c[t.tag]||(c[t.tag]=Object.assign({routes:{}},t))}),c),r.data=function(t,e,r){return(e=e?o(e):[]).forEach(function(e){e&&e.stop&&(Array.isArray(e.stop)||(e.stop=o(e.stop)),e&&e.stop&&e.stop.forEach(function(o){r[o.tag].routes[t]||(r[o.tag].routes[t]={}),r[o.tag].routes[t][e.name]=!0}))}),r}(t.route.tag,t.route.direction,r.data),e.data[t.route.tag]={title:t.route.title,color:t.route.color,tag:t.route.tag,shortTitle:t.route.shortTitle,oppositeColor:t.route.oppositeColor,max:n([t.route.latMax,t.route.lonMax]),min:n([t.route.latMin,t.route.lonMin]),stops:function(t){var e={};if((t=t?o(t):[]).forEach(function(t){var r=o(t.stop).map(function(t){return t.tag});if("Outbound"===t.name){if(!e.outbound)return void(e.outbound=r)}else if("Inbound"===t.name&&!e.inbound)return void(e.outbound=r);e[t.title]=r}),0!==Object.keys(e).length)return e}(t.route.direction)}}catch(t){throw TypeError(t.message)}return{routes:e,stops:r}}a.addScheduleData=function(t,e,r,o){return Array.isArray(e.route)||(e.route=[e.route]),r.data[t]&&(r.data[t].scheduledStops={inbound:Array.isArray(e.route)&&e.route[0].direction&&e.route[0].header.stop?e.route[0].header.stop.map(function(t){return t.tag}):void 0,outbound:Array.isArray(e.route)&&e.route.length>1&&e.route[1].direction&&e.route[1].header.stop?e.route[1].header.stop.map(function(t){return t.tag}):void 0}),e.route.forEach(function(e){e.header.stop.forEach(function(r,n){o.data[r.tag]&&(o.data[r.tag].scheduleRoutes||(o.data[r.tag].scheduleRoutes={}),o.data[r.tag].scheduleRoutes[t]||(o.data[r.tag].scheduleRoutes[t]={}),o.data[r.tag].scheduleRoutes[t][e.direction]||(o.data[r.tag].scheduleRoutes[t][e.direction]={}),o.data[r.tag].scheduleRoutes[t][e.direction][e.serviceClass]=function(t,e){if(e[0]&&Array.isArray(e[0].stop))return function(t,e){return t.map(function(t){return t.stop[e].content}).filter(function(t){if("--"!==t)return t})}(e,t)}(n,e.tr))}),r.data[t].scheduledTimeRange||(r.data[t].scheduledTimeRange={}),r.data[t]&&(r.data[t].scheduledTimeRange&&!r.data[t].scheduledTimeRange[e.direction]&&(r.data[t].scheduledTimeRange[e.direction]={}),r.data[t].scheduledTimeRange[e.direction][e.serviceClass]=function(t){if(t[0]&&Array.isArray(t[0].stop))return{first:u(t[0].stop),last:u(t[t.length-1].stop)}}(e.tr))}),{routes:r,stops:o}},t.exports=a},function(t,e){t.exports=e=window.fetch,e.default=window.fetch.bind(window),e.Headers=window.Headers,e.Request=window.Request,e.Response=window.Response},function(t,e,r){"use strict";var o=r(3);function n(t,e){var r=Object.keys(t).reduce(function(e,r){return e+r+"="+t[r]+"&"},"?"),n=o("http://webservices.nextbus.com/service/publicJSONFeed"+r).then(function(t){return t.json()});if(!e)return n;n.then(e)}t.exports={getRoutesTags:function(t,e){return n({a:t,command:"routeList"},e)},getRoute:function(t,e,r){return n({a:t,command:"routeConfig",r:e},r)},getRouteSchedule:function(t,e,r){return n({a:t,command:"schedule",r:e},r)},getAgencies:function(t){return n({command:"agencyList"},t)}}},function(t,e,r){"use strict";var o=r(4),n=r(2),u=r(1);t.exports={api:o,aggregator:n,geo:u}}])});
//# sourceMappingURL=nextbus-static-transforms.bundle.min.js.map